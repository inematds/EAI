<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Monta-Palavras - EAI Games</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', system-ui, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
      min-height: 100vh;
      overflow-x: hidden;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }

    /* Header */
    .header {
      text-align: center;
      padding: 20px;
      background: rgba(255,255,255,0.15);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      margin-bottom: 20px;
    }

    .header h1 {
      font-size: 2.2rem;
      color: white;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .stats-bar {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 15px;
      flex-wrap: wrap;
    }

    .stat {
      background: rgba(255,255,255,0.2);
      padding: 8px 16px;
      border-radius: 20px;
      color: white;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    /* Game Area */
    .game-area {
      background: rgba(255,255,255,0.95);
      border-radius: 24px;
      padding: 30px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.2);
    }

    /* Menu Screen */
    .menu-screen {
      text-align: center;
      padding: 40px 20px;
    }

    .menu-screen h2 {
      font-size: 2rem;
      color: #764ba2;
      margin-bottom: 10px;
    }

    .menu-screen p {
      color: #666;
      margin-bottom: 30px;
      font-size: 1.1rem;
    }

    .difficulty-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }

    .difficulty-btn {
      padding: 20px;
      border: none;
      border-radius: 16px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }

    .difficulty-btn:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }

    .difficulty-btn.easy {
      background: linear-gradient(135deg, #4ade80, #22c55e);
      color: white;
    }

    .difficulty-btn.medium {
      background: linear-gradient(135deg, #fbbf24, #f59e0b);
      color: white;
    }

    .difficulty-btn.hard {
      background: linear-gradient(135deg, #f87171, #ef4444);
      color: white;
    }

    .difficulty-btn span.emoji {
      font-size: 2rem;
    }

    .difficulty-btn span.desc {
      font-size: 0.85rem;
      opacity: 0.9;
    }

    /* Game Screen */
    .game-screen {
      display: none;
    }

    .game-screen.active {
      display: block;
    }

    .level-info {
      text-align: center;
      margin-bottom: 25px;
    }

    .level-info h3 {
      font-size: 1.3rem;
      color: #764ba2;
      margin-bottom: 5px;
    }

    .level-info p {
      color: #666;
    }

    /* Image Hint */
    .image-hint {
      text-align: center;
      margin-bottom: 25px;
    }

    .image-hint .emoji-display {
      font-size: 5rem;
      margin-bottom: 10px;
      animation: bounce 2s ease-in-out infinite;
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }

    .image-hint p {
      color: #888;
      font-size: 0.9rem;
    }

    /* Word Building Area */
    .word-area {
      display: flex;
      justify-content: center;
      gap: 8px;
      min-height: 70px;
      padding: 15px;
      background: linear-gradient(135deg, #f0f4ff, #e8ecff);
      border-radius: 16px;
      margin-bottom: 25px;
      flex-wrap: wrap;
    }

    .word-slot {
      width: 55px;
      height: 60px;
      background: white;
      border: 3px dashed #c4b5fd;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8rem;
      font-weight: bold;
      color: #764ba2;
      transition: all 0.3s;
    }

    .word-slot.filled {
      border-style: solid;
      border-color: #a78bfa;
      background: linear-gradient(135deg, #f5f3ff, #ede9fe);
      animation: pop 0.3s ease;
    }

    @keyframes pop {
      0% { transform: scale(0.8); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }

    /* Letter Pool */
    .letter-pool {
      display: flex;
      justify-content: center;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 25px;
    }

    .letter-btn {
      width: 55px;
      height: 60px;
      border: none;
      border-radius: 12px;
      font-size: 1.6rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.2s;
      background: linear-gradient(135deg, #8b5cf6, #7c3aed);
      color: white;
      box-shadow: 0 4px 0 #5b21b6;
    }

    .letter-btn:hover:not(:disabled) {
      transform: translateY(-3px);
      box-shadow: 0 7px 0 #5b21b6;
    }

    .letter-btn:active:not(:disabled) {
      transform: translateY(2px);
      box-shadow: 0 2px 0 #5b21b6;
    }

    .letter-btn:disabled {
      opacity: 0.3;
      cursor: not-allowed;
    }

    /* Action Buttons */
    .action-buttons {
      display: flex;
      justify-content: center;
      gap: 15px;
      flex-wrap: wrap;
    }

    .action-btn {
      padding: 12px 25px;
      border: none;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .action-btn.clear {
      background: #fecaca;
      color: #dc2626;
    }

    .action-btn.hint {
      background: #fef3c7;
      color: #d97706;
    }

    .action-btn.submit {
      background: linear-gradient(135deg, #4ade80, #22c55e);
      color: white;
      box-shadow: 0 4px 15px rgba(34, 197, 94, 0.4);
    }

    .action-btn:hover {
      transform: translateY(-2px);
    }

    /* Feedback */
    .feedback {
      text-align: center;
      padding: 20px;
      border-radius: 16px;
      margin-top: 20px;
      display: none;
    }

    .feedback.correct {
      display: block;
      background: linear-gradient(135deg, #dcfce7, #bbf7d0);
      animation: celebrate 0.5s ease;
    }

    .feedback.wrong {
      display: block;
      background: linear-gradient(135deg, #fee2e2, #fecaca);
      animation: shake 0.5s ease;
    }

    @keyframes celebrate {
      0%, 100% { transform: scale(1); }
      25% { transform: scale(1.02) rotate(-1deg); }
      75% { transform: scale(1.02) rotate(1deg); }
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      75% { transform: translateX(10px); }
    }

    .feedback h3 {
      font-size: 1.5rem;
      margin-bottom: 10px;
    }

    .feedback.correct h3 { color: #16a34a; }
    .feedback.wrong h3 { color: #dc2626; }

    .feedback p {
      color: #666;
    }

    .feedback .points {
      font-size: 1.2rem;
      font-weight: bold;
      color: #7c3aed;
      margin-top: 10px;
    }

    /* Progress Bar */
    .progress-container {
      margin-bottom: 20px;
    }

    .progress-label {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      font-size: 0.9rem;
      color: #666;
    }

    .progress-bar {
      height: 12px;
      background: #e5e7eb;
      border-radius: 6px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #8b5cf6, #ec4899);
      border-radius: 6px;
      transition: width 0.5s ease;
    }

    /* Level Complete */
    .level-complete {
      display: none;
      text-align: center;
      padding: 40px 20px;
    }

    .level-complete.active {
      display: block;
    }

    .level-complete h2 {
      font-size: 2.5rem;
      color: #7c3aed;
      margin-bottom: 15px;
    }

    .level-complete .stars {
      font-size: 3rem;
      margin-bottom: 20px;
    }

    .level-complete .summary {
      background: linear-gradient(135deg, #f5f3ff, #ede9fe);
      padding: 20px;
      border-radius: 16px;
      margin-bottom: 25px;
    }

    .level-complete .summary p {
      font-size: 1.1rem;
      color: #6b7280;
      margin: 8px 0;
    }

    .level-complete .summary strong {
      color: #7c3aed;
    }

    .next-btn {
      padding: 15px 40px;
      background: linear-gradient(135deg, #8b5cf6, #7c3aed);
      color: white;
      border: none;
      border-radius: 16px;
      font-size: 1.2rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 6px 20px rgba(124, 58, 237, 0.4);
    }

    .next-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(124, 58, 237, 0.5);
    }

    /* Medals */
    .medals-container {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-top: 20px;
      flex-wrap: wrap;
    }

    .medal {
      padding: 10px 20px;
      background: linear-gradient(135deg, #fef3c7, #fde68a);
      border-radius: 20px;
      font-weight: 600;
      color: #92400e;
      display: flex;
      align-items: center;
      gap: 8px;
      animation: medalPop 0.5s ease;
    }

    @keyframes medalPop {
      0% { transform: scale(0); opacity: 0; }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); opacity: 1; }
    }

    /* Responsive */
    @media (max-width: 600px) {
      .header h1 { font-size: 1.6rem; }
      .word-slot, .letter-btn { width: 45px; height: 50px; font-size: 1.4rem; }
      .image-hint .emoji-display { font-size: 4rem; }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <h1>üî§ Monta-Palavras</h1>
      <div class="stats-bar">
        <div class="stat">‚≠ê <span id="score">0</span> pontos</div>
        <div class="stat">üéØ N√≠vel <span id="level">1</span></div>
        <div class="stat">üèÜ <span id="streak">0</span> seguidas</div>
        <div class="stat">üí° <span id="hints">3</span> dicas</div>
      </div>
    </div>

    <!-- Game Area -->
    <div class="game-area">
      <!-- Menu Screen -->
      <div class="menu-screen" id="menuScreen">
        <h2>Escolha a Dificuldade</h2>
        <p>Monte palavras juntando as letras na ordem certa!</p>

        <div class="difficulty-grid">
          <button class="difficulty-btn easy" onclick="startGame('easy')">
            <span class="emoji">üå±</span>
            <span>F√°cil</span>
            <span class="desc">Palavras de 3-4 letras</span>
          </button>
          <button class="difficulty-btn medium" onclick="startGame('medium')">
            <span class="emoji">üåø</span>
            <span>M√©dio</span>
            <span class="desc">Palavras de 5-6 letras</span>
          </button>
          <button class="difficulty-btn hard" onclick="startGame('hard')">
            <span class="emoji">üå≥</span>
            <span>Dif√≠cil</span>
            <span class="desc">Palavras de 7+ letras</span>
          </button>
        </div>
      </div>

      <!-- Game Screen -->
      <div class="game-screen" id="gameScreen">
        <div class="progress-container">
          <div class="progress-label">
            <span>Progresso</span>
            <span><span id="currentWord">1</span>/<span id="totalWords">10</span></span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" id="progressFill" style="width: 0%"></div>
          </div>
        </div>

        <div class="level-info">
          <h3 id="wordCategory">Animais</h3>
          <p>Monte a palavra olhando a dica!</p>
        </div>

        <div class="image-hint">
          <div class="emoji-display" id="emojiHint">üêï</div>
          <p>Qual √© essa palavra?</p>
        </div>

        <div class="word-area" id="wordArea"></div>

        <div class="letter-pool" id="letterPool"></div>

        <div class="action-buttons">
          <button class="action-btn clear" onclick="clearWord()">
            üîÑ Limpar
          </button>
          <button class="action-btn hint" onclick="useHint()" id="hintBtn">
            üí° Dica
          </button>
          <button class="action-btn submit" onclick="checkWord()">
            ‚úÖ Verificar
          </button>
        </div>

        <div class="feedback" id="feedback">
          <h3 id="feedbackTitle"></h3>
          <p id="feedbackText"></p>
          <div class="points" id="feedbackPoints"></div>
        </div>
      </div>

      <!-- Level Complete Screen -->
      <div class="level-complete" id="levelComplete">
        <h2>üéâ N√≠vel Completo!</h2>
        <div class="stars" id="starsDisplay">‚≠ê‚≠ê‚≠ê</div>
        <div class="summary">
          <p>Palavras certas: <strong id="correctCount">0</strong></p>
          <p>Pontos ganhos: <strong id="pointsEarned">0</strong></p>
          <p>Maior sequ√™ncia: <strong id="maxStreak">0</strong></p>
        </div>
        <div class="medals-container" id="medalsContainer"></div>
        <button class="next-btn" onclick="nextLevel()">
          Pr√≥ximo N√≠vel ‚û°Ô∏è
        </button>
      </div>
    </div>
  </div>

  <script>
    // Word Database by category and difficulty
    const wordDatabase = {
      easy: [
        { word: 'SOL', emoji: '‚òÄÔ∏è', category: 'Natureza' },
        { word: 'LUA', emoji: 'üåô', category: 'Natureza' },
        { word: 'MAR', emoji: 'üåä', category: 'Natureza' },
        { word: 'PEZ', emoji: 'üêü', category: 'Animais' },
        { word: 'CAO', emoji: 'üêï', category: 'Animais' },
        { word: 'OVO', emoji: 'ü•ö', category: 'Comida' },
        { word: 'UVA', emoji: 'üçá', category: 'Frutas' },
        { word: 'PIA', emoji: 'üö∞', category: 'Casa' },
        { word: 'RUA', emoji: 'üõ§Ô∏è', category: 'Lugares' },
        { word: 'MAE', emoji: 'üë©', category: 'Fam√≠lia' },
        { word: 'PAI', emoji: 'üë®', category: 'Fam√≠lia' },
        { word: 'COR', emoji: 'üé®', category: 'Arte' },
        { word: 'REI', emoji: 'üëë', category: 'Fantasia' },
        { word: 'PE', emoji: 'ü¶∂', category: 'Corpo' },
        { word: 'MEL', emoji: 'üçØ', category: 'Comida' },
        { word: 'CEU', emoji: 'üå§Ô∏è', category: 'Natureza' },
        { word: 'CHA', emoji: 'üçµ', category: 'Bebidas' },
        { word: 'P√ÉO', emoji: 'üçû', category: 'Comida' },
        { word: 'FIO', emoji: 'üßµ', category: 'Objetos' },
        { word: 'N√ì', emoji: 'ü™¢', category: 'Objetos' }
      ],
      medium: [
        { word: 'GATO', emoji: 'üê±', category: 'Animais' },
        { word: 'CASA', emoji: 'üè†', category: 'Lugares' },
        { word: 'BOLA', emoji: '‚öΩ', category: 'Esportes' },
        { word: 'FLOR', emoji: 'üå∏', category: 'Natureza' },
        { word: 'PATO', emoji: 'ü¶Ü', category: 'Animais' },
        { word: 'SAPO', emoji: 'üê∏', category: 'Animais' },
        { word: 'LE√ÉO', emoji: 'ü¶Å', category: 'Animais' },
        { word: 'URSO', emoji: 'üêª', category: 'Animais' },
        { word: 'MACA', emoji: 'üçé', category: 'Frutas' },
        { word: 'BOLO', emoji: 'üéÇ', category: 'Comida' },
        { word: 'PIZZA', emoji: 'üçï', category: 'Comida' },
        { word: 'CARRO', emoji: 'üöó', category: 'Ve√≠culos' },
        { word: 'AVIAO', emoji: '‚úàÔ∏è', category: 'Ve√≠culos' },
        { word: 'NAVIO', emoji: 'üö¢', category: 'Ve√≠culos' },
        { word: 'LIVRO', emoji: 'üìö', category: 'Escola' },
        { word: 'LAPIS', emoji: '‚úèÔ∏è', category: 'Escola' },
        { word: 'ROBO', emoji: 'ü§ñ', category: 'Tecnologia' },
        { word: 'FOGUETE', emoji: 'üöÄ', category: 'Espa√ßo' },
        { word: 'ESTRELA', emoji: '‚≠ê', category: 'Espa√ßo' },
        { word: 'NUVEM', emoji: '‚òÅÔ∏è', category: 'Natureza' }
      ],
      hard: [
        { word: 'ELEFANTE', emoji: 'üêò', category: 'Animais' },
        { word: 'GIRAFA', emoji: 'ü¶í', category: 'Animais' },
        { word: 'CACHORRO', emoji: 'üêï', category: 'Animais' },
        { word: 'BORBOLETA', emoji: 'ü¶ã', category: 'Animais' },
        { word: 'TARTARUGA', emoji: 'üê¢', category: 'Animais' },
        { word: 'ABACAXI', emoji: 'üçç', category: 'Frutas' },
        { word: 'MORANGO', emoji: 'üçì', category: 'Frutas' },
        { word: 'MELANCIA', emoji: 'üçâ', category: 'Frutas' },
        { word: 'COMPUTADOR', emoji: 'üíª', category: 'Tecnologia' },
        { word: 'TELEVISAO', emoji: 'üì∫', category: 'Tecnologia' },
        { word: 'BICICLETA', emoji: 'üö≤', category: 'Ve√≠culos' },
        { word: 'HELICOPTERO', emoji: 'üöÅ', category: 'Ve√≠culos' },
        { word: 'CHOCOLATE', emoji: 'üç´', category: 'Comida' },
        { word: 'SORVETE', emoji: 'üç¶', category: 'Comida' },
        { word: 'CASTELO', emoji: 'üè∞', category: 'Lugares' },
        { word: 'MONTANHA', emoji: '‚õ∞Ô∏è', category: 'Natureza' },
        { word: 'ARCOIRIS', emoji: 'üåà', category: 'Natureza' },
        { word: 'DINOSSAURO', emoji: 'ü¶ï', category: 'Animais' },
        { word: 'UNICORNIO', emoji: 'ü¶Ñ', category: 'Fantasia' },
        { word: 'ASTRONAUTA', emoji: 'üë®‚ÄçüöÄ', category: 'Profiss√µes' }
      ]
    };

    // Game State
    let gameState = {
      difficulty: 'easy',
      currentWordIndex: 0,
      words: [],
      currentWord: '',
      currentEmoji: '',
      currentCategory: '',
      selectedLetters: [],
      availableLetters: [],
      usedIndexes: [],
      score: 0,
      level: 1,
      streak: 0,
      maxStreak: 0,
      hints: 3,
      correctInLevel: 0,
      pointsInLevel: 0
    };

    // Load saved state
    function loadState() {
      const saved = localStorage.getItem('montaPalavrasState');
      if (saved) {
        const data = JSON.parse(saved);
        gameState.score = data.score || 0;
        gameState.level = data.level || 1;
        gameState.hints = data.hints || 3;
        updateStats();
      }
    }

    // Save state
    function saveState() {
      localStorage.setItem('montaPalavrasState', JSON.stringify({
        score: gameState.score,
        level: gameState.level,
        hints: gameState.hints
      }));
    }

    // Start Game
    function startGame(difficulty) {
      gameState.difficulty = difficulty;
      gameState.currentWordIndex = 0;
      gameState.streak = 0;
      gameState.maxStreak = 0;
      gameState.correctInLevel = 0;
      gameState.pointsInLevel = 0;

      // Shuffle and select words
      const allWords = [...wordDatabase[difficulty]];
      shuffleArray(allWords);
      gameState.words = allWords.slice(0, 10);

      document.getElementById('menuScreen').style.display = 'none';
      document.getElementById('levelComplete').classList.remove('active');
      document.getElementById('gameScreen').classList.add('active');
      document.getElementById('totalWords').textContent = gameState.words.length;

      loadWord();
    }

    // Shuffle array
    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    // Load current word
    function loadWord() {
      const wordData = gameState.words[gameState.currentWordIndex];
      gameState.currentWord = wordData.word;
      gameState.currentEmoji = wordData.emoji;
      gameState.currentCategory = wordData.category;
      gameState.selectedLetters = [];
      gameState.usedIndexes = [];

      // Create shuffled letters with some extras
      const letters = wordData.word.split('');
      const extraLetters = getRandomLetters(Math.min(3, Math.floor(letters.length / 2)));
      gameState.availableLetters = [...letters, ...extraLetters];
      shuffleArray(gameState.availableLetters);

      updateDisplay();
      updateProgress();
      hideFeedback();
    }

    // Get random letters
    function getRandomLetters(count) {
      const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
      const letters = [];
      for (let i = 0; i < count; i++) {
        letters.push(alphabet[Math.floor(Math.random() * alphabet.length)]);
      }
      return letters;
    }

    // Update display
    function updateDisplay() {
      // Update category and emoji
      document.getElementById('wordCategory').textContent = gameState.currentCategory;
      document.getElementById('emojiHint').textContent = gameState.currentEmoji;
      document.getElementById('currentWord').textContent = gameState.currentWordIndex + 1;

      // Create word slots
      const wordArea = document.getElementById('wordArea');
      wordArea.innerHTML = '';
      for (let i = 0; i < gameState.currentWord.length; i++) {
        const slot = document.createElement('div');
        slot.className = 'word-slot';
        if (gameState.selectedLetters[i]) {
          slot.textContent = gameState.selectedLetters[i];
          slot.classList.add('filled');
        }
        wordArea.appendChild(slot);
      }

      // Create letter buttons
      const letterPool = document.getElementById('letterPool');
      letterPool.innerHTML = '';
      gameState.availableLetters.forEach((letter, index) => {
        const btn = document.createElement('button');
        btn.className = 'letter-btn';
        btn.textContent = letter;
        btn.disabled = gameState.usedIndexes.includes(index);
        btn.onclick = () => selectLetter(index);
        letterPool.appendChild(btn);
      });
    }

    // Select letter
    function selectLetter(index) {
      if (gameState.selectedLetters.length >= gameState.currentWord.length) return;
      if (gameState.usedIndexes.includes(index)) return;

      gameState.selectedLetters.push(gameState.availableLetters[index]);
      gameState.usedIndexes.push(index);

      playSound('click');
      updateDisplay();
    }

    // Clear word
    function clearWord() {
      gameState.selectedLetters = [];
      gameState.usedIndexes = [];
      updateDisplay();
      hideFeedback();
    }

    // Use hint
    function useHint() {
      if (gameState.hints <= 0) return;

      // Find next correct letter
      const nextIndex = gameState.selectedLetters.length;
      if (nextIndex >= gameState.currentWord.length) return;

      const correctLetter = gameState.currentWord[nextIndex];

      // Find this letter in available letters
      for (let i = 0; i < gameState.availableLetters.length; i++) {
        if (!gameState.usedIndexes.includes(i) && gameState.availableLetters[i] === correctLetter) {
          selectLetter(i);
          break;
        }
      }

      gameState.hints--;
      updateStats();
      saveState();
    }

    // Check word
    function checkWord() {
      const attempt = gameState.selectedLetters.join('');
      const feedback = document.getElementById('feedback');
      const title = document.getElementById('feedbackTitle');
      const text = document.getElementById('feedbackText');
      const points = document.getElementById('feedbackPoints');

      if (attempt.length < gameState.currentWord.length) {
        feedback.className = 'feedback wrong';
        title.textContent = 'ü§î Complete a palavra!';
        text.textContent = 'Adicione mais letras para formar a palavra.';
        points.textContent = '';
        return;
      }

      if (attempt === gameState.currentWord) {
        // Correct!
        const earnedPoints = calculatePoints();
        gameState.score += earnedPoints;
        gameState.streak++;
        gameState.maxStreak = Math.max(gameState.maxStreak, gameState.streak);
        gameState.correctInLevel++;
        gameState.pointsInLevel += earnedPoints;

        feedback.className = 'feedback correct';
        title.textContent = getRandomCelebration();
        text.textContent = `A palavra era: ${gameState.currentWord}`;
        points.textContent = `+${earnedPoints} pontos!`;

        playSound('correct');
        updateStats();
        saveState();

        // Next word after delay
        setTimeout(() => {
          gameState.currentWordIndex++;
          if (gameState.currentWordIndex >= gameState.words.length) {
            showLevelComplete();
          } else {
            loadWord();
          }
        }, 1500);

      } else {
        // Wrong
        gameState.streak = 0;
        feedback.className = 'feedback wrong';
        title.textContent = 'üòÖ Tente novamente!';
        text.textContent = 'N√£o foi dessa vez. Tente outra combina√ß√£o!';
        points.textContent = '';
        playSound('wrong');
        updateStats();
      }
    }

    // Calculate points
    function calculatePoints() {
      let base = 10;
      if (gameState.difficulty === 'medium') base = 15;
      if (gameState.difficulty === 'hard') base = 25;

      // Streak bonus
      const streakBonus = Math.min(gameState.streak * 2, 10);

      return base + streakBonus;
    }

    // Get random celebration message
    function getRandomCelebration() {
      const messages = [
        'üéâ Parab√©ns!', '‚≠ê Excelente!', 'üåü Incr√≠vel!', 'üèÜ Perfeito!',
        'üëè Muito bem!', 'üéä Fant√°stico!', 'üí™ Arrasou!', 'üî• Demais!'
      ];
      return messages[Math.floor(Math.random() * messages.length)];
    }

    // Update progress bar
    function updateProgress() {
      const progress = ((gameState.currentWordIndex) / gameState.words.length) * 100;
      document.getElementById('progressFill').style.width = progress + '%';
    }

    // Update stats
    function updateStats() {
      document.getElementById('score').textContent = gameState.score;
      document.getElementById('level').textContent = gameState.level;
      document.getElementById('streak').textContent = gameState.streak;
      document.getElementById('hints').textContent = gameState.hints;
    }

    // Hide feedback
    function hideFeedback() {
      document.getElementById('feedback').className = 'feedback';
    }

    // Show level complete
    function showLevelComplete() {
      document.getElementById('gameScreen').classList.remove('active');
      document.getElementById('levelComplete').classList.add('active');

      // Calculate stars
      const percentage = (gameState.correctInLevel / gameState.words.length) * 100;
      let stars = '‚≠ê';
      if (percentage >= 70) stars = '‚≠ê‚≠ê';
      if (percentage >= 90) stars = '‚≠ê‚≠ê‚≠ê';

      document.getElementById('starsDisplay').textContent = stars;
      document.getElementById('correctCount').textContent = gameState.correctInLevel + '/' + gameState.words.length;
      document.getElementById('pointsEarned').textContent = gameState.pointsInLevel;
      document.getElementById('maxStreak').textContent = gameState.maxStreak;

      // Show medals
      const medalsContainer = document.getElementById('medalsContainer');
      medalsContainer.innerHTML = '';

      if (gameState.correctInLevel === gameState.words.length) {
        addMedal(medalsContainer, 'üèÜ', 'Perfeito!');
      }
      if (gameState.maxStreak >= 5) {
        addMedal(medalsContainer, 'üî•', 'Sequ√™ncia de Fogo!');
      }
      if (gameState.hints === 3) {
        addMedal(medalsContainer, 'üß†', 'Sem Dicas!');
      }

      // Level up
      gameState.level++;
      gameState.hints = Math.min(gameState.hints + 1, 5);
      saveState();

      playSound('levelup');
    }

    // Add medal
    function addMedal(container, emoji, text) {
      const medal = document.createElement('div');
      medal.className = 'medal';
      medal.innerHTML = `${emoji} ${text}`;
      container.appendChild(medal);
    }

    // Next level
    function nextLevel() {
      document.getElementById('menuScreen').style.display = 'block';
      document.getElementById('levelComplete').classList.remove('active');
    }

    // Simple sound effects (using Web Audio API)
    function playSound(type) {
      try {
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();

        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);

        if (type === 'click') {
          oscillator.frequency.value = 600;
          gainNode.gain.value = 0.1;
        } else if (type === 'correct') {
          oscillator.frequency.value = 800;
          gainNode.gain.value = 0.15;
        } else if (type === 'wrong') {
          oscillator.frequency.value = 300;
          gainNode.gain.value = 0.1;
        } else if (type === 'levelup') {
          oscillator.frequency.value = 1000;
          gainNode.gain.value = 0.15;
        }

        oscillator.start();
        gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.2);
        oscillator.stop(audioContext.currentTime + 0.2);
      } catch (e) {
        // Audio not supported
      }
    }

    // Initialize
    loadState();
    updateStats();
  </script>
</body>
</html>
