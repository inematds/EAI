<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Horse Farm - Fazenda de Cavalos</title>
  <script src="eai-wallet.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', system-ui, sans-serif;
      background: linear-gradient(180deg, #87CEEB 0%, #98D8C8 50%, #7CB342 100%);
      min-height: 100vh;
      overflow-x: hidden;
    }

    .game-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      min-height: 100vh;
    }

    /* Header */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background: rgba(139, 69, 19, 0.9);
      border-radius: 20px;
      margin-bottom: 20px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    }

    .game-title {
      font-size: 28px;
      color: #FFD700;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
      font-weight: bold;
    }

    .stats-bar {
      display: flex;
      gap: 20px;
      align-items: center;
    }

    .stat {
      display: flex;
      align-items: center;
      gap: 8px;
      background: rgba(255,255,255,0.2);
      padding: 8px 15px;
      border-radius: 20px;
      color: white;
      font-weight: bold;
    }

    .stat-icon {
      font-size: 20px;
    }

    /* Main Farm Area */
    .farm-area {
      display: grid;
      grid-template-columns: 1fr 300px;
      gap: 20px;
      min-height: 600px;
    }

    .farm-scene {
      background: linear-gradient(180deg, #87CEEB 0%, #87CEEB 30%, #90EE90 30%, #228B22 100%);
      border-radius: 20px;
      position: relative;
      overflow: hidden;
      min-height: 500px;
      box-shadow: inset 0 0 50px rgba(0,0,0,0.2);
    }

    /* Sun */
    .sun {
      position: absolute;
      top: 20px;
      right: 40px;
      width: 80px;
      height: 80px;
      background: radial-gradient(circle, #FFD700 0%, #FFA500 100%);
      border-radius: 50%;
      box-shadow: 0 0 50px #FFD700;
      animation: pulse 3s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.1); opacity: 0.9; }
    }

    /* Clouds */
    .cloud {
      position: absolute;
      background: white;
      border-radius: 50px;
      animation: float 20s linear infinite;
    }

    .cloud::before, .cloud::after {
      content: '';
      position: absolute;
      background: white;
      border-radius: 50%;
    }

    .cloud-1 {
      width: 100px;
      height: 40px;
      top: 50px;
      left: -100px;
    }

    .cloud-1::before {
      width: 50px;
      height: 50px;
      top: -25px;
      left: 15px;
    }

    .cloud-1::after {
      width: 40px;
      height: 40px;
      top: -15px;
      left: 50px;
    }

    .cloud-2 {
      width: 80px;
      height: 30px;
      top: 80px;
      left: -200px;
      animation-delay: -10s;
    }

    @keyframes float {
      from { transform: translateX(0); }
      to { transform: translateX(1400px); }
    }

    /* Barn */
    .barn {
      position: absolute;
      bottom: 20%;
      left: 5%;
      width: 150px;
      height: 120px;
    }

    .barn-body {
      width: 100%;
      height: 80px;
      background: linear-gradient(135deg, #8B0000 0%, #B22222 100%);
      position: absolute;
      bottom: 0;
      border-radius: 5px;
    }

    .barn-roof {
      width: 0;
      height: 0;
      border-left: 85px solid transparent;
      border-right: 85px solid transparent;
      border-bottom: 50px solid #5C4033;
      position: absolute;
      top: 0;
      left: -10px;
    }

    .barn-door {
      width: 40px;
      height: 50px;
      background: #5C4033;
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      border-radius: 5px 5px 0 0;
    }

    .barn-window {
      width: 20px;
      height: 20px;
      background: #FFE4B5;
      position: absolute;
      top: 20px;
      border: 2px solid #5C4033;
    }

    .barn-window.left { left: 20px; }
    .barn-window.right { right: 20px; }

    /* Fence */
    .fence {
      position: absolute;
      bottom: 15%;
      left: 0;
      right: 0;
      height: 40px;
      display: flex;
      gap: 30px;
      padding: 0 20px;
    }

    .fence-post {
      width: 10px;
      height: 40px;
      background: linear-gradient(90deg, #8B4513 0%, #A0522D 50%, #8B4513 100%);
      border-radius: 2px;
      position: relative;
    }

    .fence-rail {
      position: absolute;
      height: 5px;
      background: #8B4513;
      left: 0;
      right: 0;
    }

    .fence-rail.top { top: 10px; }
    .fence-rail.bottom { top: 25px; }

    /* Horse Container */
    .horse-area {
      position: absolute;
      bottom: 18%;
      left: 50%;
      transform: translateX(-50%);
      text-align: center;
    }

    /* Horse SVG Styles */
    .horse-svg {
      transition: all 0.5s ease;
      cursor: pointer;
      filter: drop-shadow(3px 3px 5px rgba(0,0,0,0.3));
    }

    .horse-svg:hover {
      transform: scale(1.05);
    }

    /* Baby Horse */
    .horse-baby {
      width: 80px;
      height: 70px;
    }

    /* Young Horse */
    .horse-young {
      width: 120px;
      height: 100px;
    }

    /* Adult Horse */
    .horse-adult {
      width: 160px;
      height: 130px;
    }

    /* Unicorn */
    .horse-unicorn {
      width: 180px;
      height: 150px;
      filter: drop-shadow(0 0 20px rgba(255,105,180,0.6));
    }

    /* Character */
    .character-container {
      position: absolute;
      bottom: 18%;
      right: 20%;
    }

    .character-svg {
      transition: all 0.5s ease;
      filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.3));
    }

    /* Character Sizes */
    .char-child {
      width: 50px;
      height: 70px;
    }

    .char-teen {
      width: 60px;
      height: 90px;
    }

    .char-adult {
      width: 70px;
      height: 110px;
    }

    /* Grass patches */
    .grass-patch {
      position: absolute;
      bottom: 5%;
      width: 30px;
      height: 20px;
      background: linear-gradient(0deg, transparent 0%, #228B22 100%);
    }

    /* Side Panel */
    .side-panel {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .panel-card {
      background: rgba(255,255,255,0.95);
      border-radius: 20px;
      padding: 20px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }

    .panel-title {
      font-size: 18px;
      font-weight: bold;
      color: #8B4513;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    /* Progress Bars */
    .progress-container {
      margin-bottom: 15px;
    }

    .progress-label {
      display: flex;
      justify-content: space-between;
      font-size: 14px;
      color: #666;
      margin-bottom: 5px;
    }

    .progress-bar {
      height: 20px;
      background: #e0e0e0;
      border-radius: 10px;
      overflow: hidden;
      position: relative;
    }

    .progress-fill {
      height: 100%;
      border-radius: 10px;
      transition: width 0.5s ease;
      position: relative;
    }

    .progress-fill.hunger {
      background: linear-gradient(90deg, #FF6B6B, #FF8E53);
    }

    .progress-fill.happiness {
      background: linear-gradient(90deg, #FFD93D, #FF6B6B);
    }

    .progress-fill.growth {
      background: linear-gradient(90deg, #6BCB77, #4D96FF);
    }

    .progress-fill.magic {
      background: linear-gradient(90deg, #9B59B6, #E91E63, #FF9800);
      animation: rainbow 3s linear infinite;
    }

    @keyframes rainbow {
      0% { filter: hue-rotate(0deg); }
      100% { filter: hue-rotate(360deg); }
    }

    /* Food Grid */
    .food-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
    }

    .food-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 10px;
      background: #f5f5f5;
      border-radius: 15px;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 2px solid transparent;
    }

    .food-item:hover {
      background: #e8f5e9;
      border-color: #4CAF50;
      transform: translateY(-3px);
    }

    .food-item.disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .food-emoji {
      font-size: 30px;
      margin-bottom: 5px;
    }

    .food-name {
      font-size: 11px;
      color: #666;
      text-align: center;
    }

    .food-points {
      font-size: 10px;
      color: #4CAF50;
      font-weight: bold;
    }

    /* Activities */
    .activity-btn {
      width: 100%;
      padding: 12px;
      margin-bottom: 10px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .activity-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
    }

    .activity-btn.play {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    }

    .activity-btn.brush {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    }

    .activity-btn.sleep {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    /* Stage Indicator */
    .stage-indicator {
      text-align: center;
      padding: 15px;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      border-radius: 15px;
      margin-bottom: 15px;
    }

    .stage-name {
      font-size: 20px;
      font-weight: bold;
      color: #333;
      margin-bottom: 5px;
    }

    .stage-emoji {
      font-size: 40px;
      margin-bottom: 10px;
    }

    .stage-description {
      font-size: 12px;
      color: #666;
    }

    /* Unicorn Progress */
    .unicorn-section {
      background: linear-gradient(135deg, #f5f7fa 0%, #e8daef 100%);
      border-radius: 15px;
      padding: 15px;
      text-align: center;
    }

    .unicorn-title {
      font-size: 14px;
      color: #9B59B6;
      font-weight: bold;
      margin-bottom: 10px;
    }

    .unicorn-requirement {
      font-size: 12px;
      color: #666;
      margin-top: 10px;
    }

    /* Animations */
    .eating-animation {
      animation: eat 0.5s ease-in-out;
    }

    @keyframes eat {
      0%, 100% { transform: translateX(-50%) rotate(0deg); }
      25% { transform: translateX(-50%) rotate(-5deg); }
      75% { transform: translateX(-50%) rotate(5deg); }
    }

    .happy-animation {
      animation: happy 0.8s ease-in-out;
    }

    @keyframes happy {
      0%, 100% { transform: translateX(-50%) translateY(0); }
      50% { transform: translateX(-50%) translateY(-20px); }
    }

    /* Evolution Effect */
    .evolving {
      animation: evolve 2s ease-in-out;
    }

    @keyframes evolve {
      0% { transform: translateX(-50%) scale(1); filter: brightness(1); }
      50% { transform: translateX(-50%) scale(1.3); filter: brightness(2) hue-rotate(180deg); }
      100% { transform: translateX(-50%) scale(1); filter: brightness(1); }
    }

    /* Sparkles for Unicorn */
    .sparkle {
      position: absolute;
      width: 10px;
      height: 10px;
      background: radial-gradient(circle, #FFD700 0%, transparent 70%);
      border-radius: 50%;
      animation: sparkle 1.5s ease-in-out infinite;
      pointer-events: none;
    }

    @keyframes sparkle {
      0%, 100% { opacity: 0; transform: scale(0); }
      50% { opacity: 1; transform: scale(1); }
    }

    /* Intro Screen */
    .intro-screen {
      position: fixed;
      inset: 0;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .intro-title {
      font-size: 48px;
      color: white;
      text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
      margin-bottom: 30px;
    }

    .intro-subtitle {
      font-size: 20px;
      color: rgba(255,255,255,0.9);
      margin-bottom: 50px;
    }

    .gender-selection {
      display: flex;
      gap: 40px;
    }

    .gender-option {
      padding: 30px 50px;
      background: rgba(255,255,255,0.2);
      border: 3px solid transparent;
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
    }

    .gender-option:hover {
      background: rgba(255,255,255,0.3);
      transform: translateY(-5px);
      border-color: white;
    }

    .gender-emoji {
      font-size: 80px;
      margin-bottom: 15px;
    }

    .gender-label {
      font-size: 20px;
      color: white;
      font-weight: bold;
    }

    /* Day/Night Cycle indicator */
    .time-indicator {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(0,0,0,0.5);
      color: white;
      padding: 8px 15px;
      border-radius: 20px;
      font-size: 14px;
    }

    /* Achievements */
    .achievement-popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
      padding: 30px 50px;
      border-radius: 20px;
      text-align: center;
      z-index: 100;
      animation: popIn 0.5s ease;
      box-shadow: 0 10px 40px rgba(0,0,0,0.3);
    }

    @keyframes popIn {
      0% { transform: translate(-50%, -50%) scale(0); }
      80% { transform: translate(-50%, -50%) scale(1.1); }
      100% { transform: translate(-50%, -50%) scale(1); }
    }

    .achievement-emoji {
      font-size: 60px;
      margin-bottom: 15px;
    }

    .achievement-title {
      font-size: 24px;
      font-weight: bold;
      color: #333;
      margin-bottom: 10px;
    }

    .achievement-desc {
      font-size: 16px;
      color: #666;
      margin-bottom: 20px;
    }

    .achievement-close {
      padding: 10px 30px;
      background: #333;
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-size: 14px;
    }

    /* Food storage area */
    .food-storage {
      position: absolute;
      bottom: 5%;
      right: 5%;
      display: flex;
      gap: 10px;
    }

    .food-bowl {
      width: 60px;
      height: 40px;
      background: linear-gradient(180deg, #A0522D 0%, #8B4513 100%);
      border-radius: 5px 5px 30px 30px;
      position: relative;
      cursor: pointer;
      transition: transform 0.3s ease;
    }

    .food-bowl:hover {
      transform: scale(1.1);
    }

    .food-bowl::before {
      content: '';
      position: absolute;
      top: 5px;
      left: 5px;
      right: 5px;
      height: 15px;
      background: #DEB887;
      border-radius: 3px;
    }

    .water-trough {
      width: 80px;
      height: 35px;
      background: linear-gradient(180deg, #708090 0%, #4a5568 100%);
      border-radius: 5px;
      position: relative;
    }

    .water-trough::before {
      content: '';
      position: absolute;
      top: 5px;
      left: 5px;
      right: 5px;
      bottom: 5px;
      background: linear-gradient(180deg, #4FC3F7 0%, #29B6F6 100%);
      border-radius: 3px;
      animation: waterWave 2s ease-in-out infinite;
    }

    @keyframes waterWave {
      0%, 100% { transform: scaleY(1); }
      50% { transform: scaleY(0.95); }
    }

    /* Responsive */
    @media (max-width: 900px) {
      .farm-area {
        grid-template-columns: 1fr;
      }

      .side-panel {
        display: grid;
        grid-template-columns: 1fr 1fr;
      }
    }

    @media (max-width: 600px) {
      .game-title {
        font-size: 20px;
      }

      .stats-bar {
        gap: 10px;
      }

      .stat {
        padding: 5px 10px;
        font-size: 12px;
      }

      .side-panel {
        grid-template-columns: 1fr;
      }

      .intro-title {
        font-size: 32px;
      }

      .gender-selection {
        flex-direction: column;
        gap: 20px;
      }
    }

    .hidden {
      display: none !important;
    }

    /* === MODAL DE INSTRU√á√ïES === */
    .instructions-modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.85);
      z-index: 9999;
      padding: 1rem;
      overflow-y: auto;
    }

    .instructions-modal.active {
      display: flex;
      align-items: flex-start;
      justify-content: center;
    }

    .instructions-content {
      background: linear-gradient(180deg, #E8F5E9 0%, #C8E6C9 100%);
      border-radius: 20px;
      padding: 25px;
      max-width: 550px;
      width: 100%;
      margin: 20px auto;
      position: relative;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
      border: 4px solid #4CAF50;
    }

    .close-instructions {
      position: absolute;
      top: 10px;
      right: 10px;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: #f44336;
      color: white;
      border: none;
      font-size: 1.3rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }

    .close-instructions:hover {
      background: #d32f2f;
      transform: scale(1.1);
    }

    .instructions-title {
      text-align: center;
      font-size: 1.8rem;
      color: #2E7D32;
      margin-bottom: 1.5rem;
    }

    .instructions-section {
      background: white;
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 12px;
      border-left: 4px solid #4CAF50;
    }

    .instructions-section h3 {
      color: #2E7D32;
      font-size: 1.1rem;
      margin-bottom: 8px;
    }

    .instructions-section p {
      color: #555;
      line-height: 1.5;
      font-size: 0.95rem;
    }

    .instructions-section ul {
      list-style: none;
      padding: 0;
    }

    .instructions-section li {
      padding: 6px 0;
      color: #444;
      border-bottom: 1px dashed #E0E0E0;
      font-size: 0.95rem;
    }

    .instructions-section li:last-child {
      border-bottom: none;
    }

    .instructions-section.magic-tips {
      background: linear-gradient(135deg, #FFF8E1, #FFECB3);
      border-left-color: #FF9800;
    }

    .instructions-section.magic-tips h3 {
      color: #E65100;
    }

    .instructions-section.magic-tips li {
      color: #BF360C;
      border-bottom-color: #FFE0B2;
    }

    .help-btn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: linear-gradient(135deg, #9C27B0, #7B1FA2);
      color: white;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(156, 39, 176, 0.4);
      z-index: 100;
      transition: all 0.3s;
    }

    .help-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 20px rgba(156, 39, 176, 0.6);
    }

    .intro-help-btn {
      padding: 15px 40px;
      background: linear-gradient(135deg, #9C27B0, #7B1FA2);
      color: white;
      border: 3px solid transparent;
      border-radius: 15px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      margin-top: 20px;
      transition: all 0.3s;
    }

    .intro-help-btn:hover {
      transform: translateY(-3px);
      border-color: white;
    }
  </style>
</head>
<body>
  <!-- Intro Screen -->
  <div class="intro-screen" id="introScreen">
    <h1 class="intro-title">üê¥ Horse Farm üåæ</h1>
    <p class="intro-subtitle">Cuide do seu cavalo e veja ele crescer!</p>
    <div class="gender-selection">
      <div class="gender-option" onclick="selectGender('girl')">
        <div class="gender-emoji">üëß</div>
        <div class="gender-label">Menina</div>
      </div>
      <div class="gender-option" onclick="selectGender('boy')">
        <div class="gender-emoji">üë¶</div>
        <div class="gender-label">Menino</div>
      </div>
    </div>
    <button class="intro-help-btn" onclick="showInstructions()">üìñ Como Jogar</button>
  </div>

  <!-- Bot√£o de ajuda flutuante -->
  <button class="help-btn" onclick="showInstructions()" title="Como Jogar">‚ùì</button>

  <!-- Modal de Instru√ß√µes -->
  <div class="instructions-modal" id="instructionsModal">
    <div class="instructions-content">
      <button class="close-instructions" onclick="hideInstructions()">‚úï</button>
      <h2 class="instructions-title">üìñ Como Jogar</h2>

      <div class="instructions-section">
        <h3>üéÆ Sobre o Jogo</h3>
        <p>Bem-vindo √† Horse Farm! Cuide de um cavalo beb√™ e veja ele crescer at√© se tornar um majestoso unic√≥rnio m√°gico!</p>
      </div>

      <div class="instructions-section">
        <h3>üéØ Recursos do Jogo</h3>
        <ul>
          <li>üë§ <strong>Escolha seu Personagem</strong> - Menino ou menina que cresce junto com o cavalo</li>
          <li>üê¥ <strong>Cavalo Beb√™</strong> - Cuide dele desde filhote at√© adulto</li>
          <li>üçé <strong>Alimenta√ß√£o</strong> - Feno, ma√ß√£, cenoura, √°gua, a√ß√∫car e aveia</li>
          <li>üéæ <strong>Atividades</strong> - Brincar, escovar e fazer o cavalo dormir</li>
          <li>üìä <strong>Barras de Status</strong> - Fome, felicidade e crescimento</li>
          <li>ü¶Ñ <strong>Evolu√ß√£o M√°gica</strong> - Transforme seu cavalo em unic√≥rnio!</li>
        </ul>
      </div>

      <div class="instructions-section">
        <h3>‚öîÔ∏è Desafios</h3>
        <ul>
          <li>üçé Mantenha seu cavalo sempre alimentado e feliz</li>
          <li>üìà Fa√ßa o cavalo crescer pelos 3 est√°gios (Beb√™ ‚Üí Jovem ‚Üí Adulto)</li>
          <li>‚≠ê Acumule 1000 pontos para desbloquear a evolu√ß√£o para unic√≥rnio</li>
          <li>üí∞ Ganhe moedas cuidando bem do seu cavalo</li>
        </ul>
      </div>

      <div class="instructions-section magic-tips">
        <h3>‚ú® Dicas M√°gicas</h3>
        <ul>
          <li>üåü <strong>A√ß√∫car d√° mais pontos!</strong> Mas n√£o enche tanto a fome</li>
          <li>üåü <strong>Brincar gasta fome</strong> - alimente antes de brincar muito</li>
          <li>üåü <strong>Dormir avan√ßa o dia</strong> e d√° b√¥nus de crescimento</li>
          <li>üåü <strong>Clique nas tigelas</strong> da fazenda para alimentar rapidamente</li>
          <li>üåü <strong>O unic√≥rnio aparece</strong> quando voc√™ tiver 1000+ pontos e cavalo adulto!</li>
        </ul>
      </div>

      <button class="intro-help-btn" style="width: 100%;" onclick="hideInstructions()">Entendi! üê¥</button>
    </div>
  </div>

  <!-- Main Game -->
  <div class="game-container hidden" id="gameContainer">
    <header class="header">
      <h1 class="game-title">üê¥ Horse Farm</h1>
      <div class="stats-bar">
        <div class="stat">
          <span class="stat-icon">üìÖ</span>
          <span id="dayCount">Dia 1</span>
        </div>
        <div class="stat">
          <span class="stat-icon">‚≠ê</span>
          <span id="totalPoints">0 pts</span>
        </div>
        <div class="stat">
          <span class="stat-icon">ü™ô</span>
          <span id="coinDisplay">0</span>
        </div>
      </div>
    </header>

    <div class="farm-area">
      <div class="farm-scene" id="farmScene">
        <div class="sun"></div>
        <div class="cloud cloud-1"></div>
        <div class="cloud cloud-2"></div>

        <div class="time-indicator" id="timeIndicator">‚òÄÔ∏è Manh√£</div>

        <!-- Barn -->
        <div class="barn">
          <div class="barn-roof"></div>
          <div class="barn-body">
            <div class="barn-window left"></div>
            <div class="barn-window right"></div>
            <div class="barn-door"></div>
          </div>
        </div>

        <!-- Fence -->
        <div class="fence" id="fence"></div>

        <!-- Horse Area -->
        <div class="horse-area" id="horseArea">
          <!-- Horse will be rendered here -->
        </div>

        <!-- Character -->
        <div class="character-container" id="characterContainer">
          <!-- Character will be rendered here -->
        </div>

        <!-- Food Storage -->
        <div class="food-storage">
          <div class="food-bowl" onclick="quickFeed('hay')" title="Feno"></div>
          <div class="water-trough" onclick="quickFeed('water')" title="√Ågua"></div>
        </div>

        <!-- Grass patches -->
        <div class="grass-patch" style="left: 20%;"></div>
        <div class="grass-patch" style="left: 40%;"></div>
        <div class="grass-patch" style="left: 60%;"></div>
        <div class="grass-patch" style="left: 80%;"></div>
      </div>

      <div class="side-panel">
        <!-- Stage Indicator -->
        <div class="panel-card">
          <div class="stage-indicator">
            <div class="stage-emoji" id="stageEmoji">üê¥</div>
            <div class="stage-name" id="stageName">Potro Beb√™</div>
            <div class="stage-description" id="stageDesc">Seu cavalinho acabou de nascer!</div>
          </div>

          <!-- Unicorn Section -->
          <div class="unicorn-section" id="unicornSection">
            <div class="unicorn-title">ü¶Ñ Evolu√ß√£o M√°gica</div>
            <div class="progress-bar">
              <div class="progress-fill magic" id="magicProgress" style="width: 0%"></div>
            </div>
            <div class="unicorn-requirement" id="unicornReq">Acumule 1000 pontos para transformar em unic√≥rnio!</div>
          </div>
        </div>

        <!-- Horse Stats -->
        <div class="panel-card">
          <div class="panel-title">
            <span>üìä</span> Status do Cavalo
          </div>

          <div class="progress-container">
            <div class="progress-label">
              <span>üçé Fome</span>
              <span id="hungerValue">100%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill hunger" id="hungerBar" style="width: 100%"></div>
            </div>
          </div>

          <div class="progress-container">
            <div class="progress-label">
              <span>üòä Felicidade</span>
              <span id="happinessValue">100%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill happiness" id="happinessBar" style="width: 100%"></div>
            </div>
          </div>

          <div class="progress-container">
            <div class="progress-label">
              <span>üìà Crescimento</span>
              <span id="growthValue">0%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill growth" id="growthBar" style="width: 0%"></div>
            </div>
          </div>
        </div>

        <!-- Food Options -->
        <div class="panel-card">
          <div class="panel-title">
            <span>üçΩÔ∏è</span> Alimentar
          </div>
          <div class="food-grid">
            <div class="food-item" onclick="feed('hay')">
              <span class="food-emoji">üåæ</span>
              <span class="food-name">Feno</span>
              <span class="food-points">+10</span>
            </div>
            <div class="food-item" onclick="feed('apple')">
              <span class="food-emoji">üçé</span>
              <span class="food-name">Ma√ß√£</span>
              <span class="food-points">+15</span>
            </div>
            <div class="food-item" onclick="feed('carrot')">
              <span class="food-emoji">ü•ï</span>
              <span class="food-name">Cenoura</span>
              <span class="food-points">+12</span>
            </div>
            <div class="food-item" onclick="feed('water')">
              <span class="food-emoji">üíß</span>
              <span class="food-name">√Ågua</span>
              <span class="food-points">+8</span>
            </div>
            <div class="food-item" onclick="feed('sugar')">
              <span class="food-emoji">üç¨</span>
              <span class="food-name">A√ß√∫car</span>
              <span class="food-points">+20</span>
            </div>
            <div class="food-item" onclick="feed('oats')">
              <span class="food-emoji">üåø</span>
              <span class="food-name">Aveia</span>
              <span class="food-points">+18</span>
            </div>
          </div>
        </div>

        <!-- Activities -->
        <div class="panel-card">
          <div class="panel-title">
            <span>üéÆ</span> Atividades
          </div>
          <button class="activity-btn play" onclick="playWithHorse()">
            <span>üéæ</span> Brincar (+25 felicidade)
          </button>
          <button class="activity-btn brush" onclick="brushHorse()">
            <span>ü™Æ</span> Escovar (+20 felicidade)
          </button>
          <button class="activity-btn sleep" onclick="sleepHorse()">
            <span>üò¥</span> Dormir (Avan√ßa o dia)
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Achievement Popup -->
  <div class="achievement-popup hidden" id="achievementPopup">
    <div class="achievement-emoji" id="achieveEmoji">üèÜ</div>
    <div class="achievement-title" id="achieveTitle">Conquista!</div>
    <div class="achievement-desc" id="achieveDesc">Voc√™ conseguiu!</div>
    <button class="achievement-close" onclick="closeAchievement()">Continuar</button>
  </div>

  <script>
    // Game State
    const gameState = {
      gender: null,
      day: 1,
      timeOfDay: 'morning', // morning, afternoon, evening, night
      totalPoints: 0,
      horse: {
        stage: 0, // 0: baby, 1: young, 2: adult, 3: unicorn
        hunger: 100,
        happiness: 100,
        growth: 0,
        color: '#8B4513',
        isUnicorn: false
      },
      character: {
        stage: 0, // 0: child, 1: teen, 2: adult
        growth: 0
      },
      achievements: []
    };

    const STAGES = {
      horse: [
        { name: 'Potro Beb√™', emoji: 'üê¥', desc: 'Seu cavalinho acabou de nascer!', growthNeeded: 0 },
        { name: 'Potro Jovem', emoji: 'üêé', desc: 'Seu cavalo est√° crescendo forte!', growthNeeded: 100 },
        { name: 'Cavalo Adulto', emoji: 'üèá', desc: 'Um belo cavalo adulto!', growthNeeded: 250 },
        { name: 'Unic√≥rnio M√°gico', emoji: 'ü¶Ñ', desc: 'Incr√≠vel! Um unic√≥rnio!', growthNeeded: 1000 }
      ],
      character: [
        { name: 'Crian√ßa', size: 'child' },
        { name: 'Adolescente', size: 'teen' },
        { name: 'Adulto', size: 'adult' }
      ]
    };

    const FOODS = {
      hay: { hunger: 10, growth: 5, points: 10 },
      apple: { hunger: 15, growth: 8, points: 15 },
      carrot: { hunger: 12, growth: 6, points: 12 },
      water: { hunger: 8, growth: 3, points: 8 },
      sugar: { hunger: 5, growth: 10, points: 20, happiness: 15 },
      oats: { hunger: 18, growth: 12, points: 18 }
    };

    const TIME_CYCLE = ['morning', 'afternoon', 'evening', 'night'];
    const TIME_LABELS = {
      morning: '‚òÄÔ∏è Manh√£',
      afternoon: 'üå§Ô∏è Tarde',
      evening: 'üåÖ Entardecer',
      night: 'üåô Noite'
    };

    // Load saved game
    function loadGame() {
      const saved = localStorage.getItem('horseFarm');
      if (saved) {
        const data = JSON.parse(saved);
        Object.assign(gameState, data);
        return true;
      }
      return false;
    }

    // Save game
    function saveGame() {
      localStorage.setItem('horseFarm', JSON.stringify(gameState));
    }

    // Instru√ß√µes
    function showInstructions() {
      document.getElementById('instructionsModal').classList.add('active');
    }

    function hideInstructions() {
      document.getElementById('instructionsModal').classList.remove('active');
    }

    // Select gender and start game
    function selectGender(gender) {
      gameState.gender = gender;
      document.getElementById('introScreen').classList.add('hidden');
      document.getElementById('gameContainer').classList.remove('hidden');
      initGame();
    }

    // Initialize game
    function initGame() {
      createFence();
      renderHorse();
      renderCharacter();
      updateUI();
      startGameLoop();

      // Initial reward
      if (typeof EAI !== 'undefined') {
        EAI.showToast('Bem-vindo √† fazenda!', 'info');
      }
    }

    // Create fence posts
    function createFence() {
      const fence = document.getElementById('fence');
      fence.innerHTML = '<div class="fence-rail top"></div><div class="fence-rail bottom"></div>';

      for (let i = 0; i < 15; i++) {
        const post = document.createElement('div');
        post.className = 'fence-post';
        fence.appendChild(post);
      }
    }

    // Render horse based on stage
    function renderHorse() {
      const horseArea = document.getElementById('horseArea');
      const stage = gameState.horse.stage;
      const isUnicorn = gameState.horse.isUnicorn;

      let sizeClass = ['horse-baby', 'horse-young', 'horse-adult', 'horse-unicorn'][stage];
      let horseColor = gameState.horse.color;

      // Generate horse SVG
      let horseSVG;

      if (isUnicorn) {
        horseSVG = generateUnicornSVG(horseColor);
        // Add sparkles
        addSparkles(horseArea);
      } else {
        horseSVG = generateHorseSVG(horseColor, stage);
      }

      horseArea.innerHTML = `
        <svg class="horse-svg ${sizeClass}" viewBox="0 0 100 80" id="horseSvg">
          ${horseSVG}
        </svg>
      `;
    }

    // Generate horse SVG
    function generateHorseSVG(color, stage) {
      const sizes = [
        { body: 25, head: 12, legs: 15 }, // baby
        { body: 35, head: 16, legs: 22 }, // young
        { body: 45, head: 20, legs: 28 }, // adult
        { body: 45, head: 20, legs: 28 }  // unicorn base
      ];

      const s = sizes[stage];
      const darkerColor = shadeColor(color, -20);

      return `
        <!-- Body -->
        <ellipse cx="50" cy="45" rx="${s.body}" ry="${s.body * 0.6}" fill="${color}"/>

        <!-- Head -->
        <ellipse cx="25" cy="30" rx="${s.head}" ry="${s.head * 0.8}" fill="${color}" transform="rotate(-20, 25, 30)"/>

        <!-- Ear -->
        <path d="M 15 18 Q 12 10 18 15" stroke="${color}" stroke-width="4" fill="${color}"/>

        <!-- Eye -->
        <circle cx="20" cy="28" r="3" fill="#333"/>
        <circle cx="19" cy="27" r="1" fill="white"/>

        <!-- Muzzle -->
        <ellipse cx="15" cy="35" rx="6" ry="4" fill="${darkerColor}"/>
        <circle cx="13" cy="34" r="1" fill="#333"/>
        <circle cx="17" cy="34" r="1" fill="#333"/>

        <!-- Mane -->
        <path d="M 30 20 Q 35 15 40 20 Q 45 25 50 20 Q 55 15 55 25"
              stroke="${darkerColor}" stroke-width="5" fill="none" stroke-linecap="round"/>

        <!-- Tail -->
        <path d="M 95 45 Q 105 50 100 60 Q 95 70 90 65"
              stroke="${darkerColor}" stroke-width="4" fill="none" stroke-linecap="round"/>

        <!-- Legs -->
        <rect x="30" y="55" width="6" height="${s.legs}" rx="2" fill="${darkerColor}"/>
        <rect x="42" y="55" width="6" height="${s.legs}" rx="2" fill="${darkerColor}"/>
        <rect x="58" y="55" width="6" height="${s.legs}" rx="2" fill="${darkerColor}"/>
        <rect x="70" y="55" width="6" height="${s.legs}" rx="2" fill="${darkerColor}"/>

        <!-- Hooves -->
        <rect x="29" y="${55 + s.legs - 5}" width="8" height="5" rx="1" fill="#333"/>
        <rect x="41" y="${55 + s.legs - 5}" width="8" height="5" rx="1" fill="#333"/>
        <rect x="57" y="${55 + s.legs - 5}" width="8" height="5" rx="1" fill="#333"/>
        <rect x="69" y="${55 + s.legs - 5}" width="8" height="5" rx="1" fill="#333"/>
      `;
    }

    // Generate Unicorn SVG
    function generateUnicornSVG(color) {
      const baseSVG = generateHorseSVG('#FFFFFF', 3);

      return `
        ${baseSVG}

        <!-- Horn -->
        <polygon points="18,15 22,0 26,15" fill="url(#hornGradient)"/>
        <defs>
          <linearGradient id="hornGradient" x1="0%" y1="0%" x2="0%" y2="100%">
            <stop offset="0%" style="stop-color:#FFD700"/>
            <stop offset="50%" style="stop-color:#FFA500"/>
            <stop offset="100%" style="stop-color:#FF69B4"/>
          </linearGradient>
        </defs>

        <!-- Rainbow mane -->
        <path d="M 30 20 Q 35 12 40 18 Q 45 24 50 16 Q 55 8 58 20"
              stroke="url(#rainbowGradient)" stroke-width="6" fill="none" stroke-linecap="round"/>
        <defs>
          <linearGradient id="rainbowGradient" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" style="stop-color:#FF0000"/>
            <stop offset="20%" style="stop-color:#FF7F00"/>
            <stop offset="40%" style="stop-color:#FFFF00"/>
            <stop offset="60%" style="stop-color:#00FF00"/>
            <stop offset="80%" style="stop-color:#0000FF"/>
            <stop offset="100%" style="stop-color:#8B00FF"/>
          </linearGradient>
        </defs>

        <!-- Rainbow tail -->
        <path d="M 95 45 Q 108 50 103 62 Q 98 74 88 68"
              stroke="url(#rainbowGradient)" stroke-width="5" fill="none" stroke-linecap="round"/>

        <!-- Wings -->
        <path d="M 55 35 Q 75 15 85 30 Q 75 25 65 35" fill="#E6E6FA" stroke="#DDA0DD" stroke-width="1"/>
        <path d="M 50 38 Q 70 20 78 33 Q 68 28 58 38" fill="#E6E6FA" stroke="#DDA0DD" stroke-width="1"/>
      `;
    }

    // Add sparkles around unicorn
    function addSparkles(container) {
      for (let i = 0; i < 8; i++) {
        const sparkle = document.createElement('div');
        sparkle.className = 'sparkle';
        sparkle.style.left = `${Math.random() * 100}%`;
        sparkle.style.top = `${Math.random() * 100}%`;
        sparkle.style.animationDelay = `${Math.random() * 1.5}s`;
        container.appendChild(sparkle);
      }
    }

    // Render character
    function renderCharacter() {
      const container = document.getElementById('characterContainer');
      const stage = gameState.character.stage;
      const gender = gameState.gender;

      const sizeClass = ['char-child', 'char-teen', 'char-adult'][stage];
      const skinColor = '#FFDAB9';
      const hairColor = gender === 'girl' ? '#8B4513' : '#2F1810';
      const clothColor = gender === 'girl' ? '#FF69B4' : '#4169E1';

      container.innerHTML = `
        <svg class="character-svg ${sizeClass}" viewBox="0 0 50 80">
          <!-- Head -->
          <circle cx="25" cy="15" r="12" fill="${skinColor}"/>

          <!-- Hair -->
          ${gender === 'girl' ? `
            <path d="M 13 12 Q 10 5 25 3 Q 40 5 37 12 Q 35 8 25 6 Q 15 8 13 12" fill="${hairColor}"/>
            <path d="M 13 15 Q 8 25 10 35" stroke="${hairColor}" stroke-width="4" fill="none"/>
            <path d="M 37 15 Q 42 25 40 35" stroke="${hairColor}" stroke-width="4" fill="none"/>
          ` : `
            <path d="M 13 10 Q 15 3 25 2 Q 35 3 37 10 Q 35 6 25 5 Q 15 6 13 10" fill="${hairColor}"/>
          `}

          <!-- Eyes -->
          <circle cx="20" cy="14" r="2" fill="#333"/>
          <circle cx="30" cy="14" r="2" fill="#333"/>
          <circle cx="19" cy="13" r="0.8" fill="white"/>
          <circle cx="29" cy="13" r="0.8" fill="white"/>

          <!-- Mouth -->
          <path d="M 22 20 Q 25 23 28 20" stroke="#333" stroke-width="1.5" fill="none"/>

          <!-- Body/Shirt -->
          <rect x="15" y="28" width="20" height="25" rx="3" fill="${clothColor}"/>

          <!-- Arms -->
          <rect x="8" y="28" width="7" height="20" rx="3" fill="${clothColor}"/>
          <rect x="35" y="28" width="7" height="20" rx="3" fill="${clothColor}"/>

          <!-- Hands -->
          <circle cx="11" cy="50" r="4" fill="${skinColor}"/>
          <circle cx="39" cy="50" r="4" fill="${skinColor}"/>

          <!-- Legs/Pants -->
          <rect x="17" y="53" width="7" height="20" rx="2" fill="#4a5568"/>
          <rect x="26" y="53" width="7" height="20" rx="2" fill="#4a5568"/>

          <!-- Shoes -->
          <ellipse cx="20" cy="75" rx="5" ry="3" fill="#333"/>
          <ellipse cx="30" cy="75" rx="5" ry="3" fill="#333"/>
        </svg>
      `;
    }

    // Update UI
    function updateUI() {
      // Update stats display
      document.getElementById('dayCount').textContent = `Dia ${gameState.day}`;
      document.getElementById('totalPoints').textContent = `${gameState.totalPoints} pts`;

      // Update bars
      document.getElementById('hungerBar').style.width = `${gameState.horse.hunger}%`;
      document.getElementById('hungerValue').textContent = `${Math.round(gameState.horse.hunger)}%`;

      document.getElementById('happinessBar').style.width = `${gameState.horse.happiness}%`;
      document.getElementById('happinessValue').textContent = `${Math.round(gameState.horse.happiness)}%`;

      const growthPercent = Math.min(100, (gameState.horse.growth / STAGES.horse[3].growthNeeded) * 100);
      document.getElementById('growthBar').style.width = `${growthPercent}%`;
      document.getElementById('growthValue').textContent = `${Math.round(growthPercent)}%`;

      // Update stage info
      const stage = STAGES.horse[gameState.horse.stage];
      document.getElementById('stageEmoji').textContent = gameState.horse.isUnicorn ? 'ü¶Ñ' : stage.emoji;
      document.getElementById('stageName').textContent = gameState.horse.isUnicorn ? 'Unic√≥rnio M√°gico' : stage.name;
      document.getElementById('stageDesc').textContent = gameState.horse.isUnicorn ? 'Incr√≠vel! Seu cavalo virou um unic√≥rnio!' : stage.desc;

      // Update unicorn progress
      const unicornProgress = Math.min(100, (gameState.totalPoints / 1000) * 100);
      document.getElementById('magicProgress').style.width = `${unicornProgress}%`;

      if (gameState.horse.isUnicorn) {
        document.getElementById('unicornReq').textContent = '‚ú® Unic√≥rnio desbloqueado!';
      } else {
        document.getElementById('unicornReq').textContent = `${gameState.totalPoints}/1000 pontos para unic√≥rnio`;
      }

      // Update time
      document.getElementById('timeIndicator').textContent = TIME_LABELS[gameState.timeOfDay];

      // Update coins
      if (typeof EAI !== 'undefined') {
        document.getElementById('coinDisplay').textContent = EAI.getWallet().coins;
      }

      saveGame();
    }

    // Feed horse
    function feed(foodType) {
      const food = FOODS[foodType];
      if (!food) return;

      // Add hunger
      gameState.horse.hunger = Math.min(100, gameState.horse.hunger + food.hunger);

      // Add growth
      gameState.horse.growth += food.growth;

      // Add points
      gameState.totalPoints += food.points;

      // Add happiness if applicable
      if (food.happiness) {
        gameState.horse.happiness = Math.min(100, gameState.horse.happiness + food.happiness);
      }

      // Animation
      const horseArea = document.getElementById('horseArea');
      horseArea.classList.add('eating-animation');
      setTimeout(() => horseArea.classList.remove('eating-animation'), 500);

      // Show reward
      if (typeof EAI !== 'undefined') {
        EAI.showToast(`+${food.points} pontos`, 'success');
      }

      // Check evolution
      checkEvolution();
      updateUI();
    }

    // Quick feed from scene
    function quickFeed(type) {
      feed(type);
    }

    // Play with horse
    function playWithHorse() {
      gameState.horse.happiness = Math.min(100, gameState.horse.happiness + 25);
      gameState.horse.hunger = Math.max(0, gameState.horse.hunger - 10);
      gameState.horse.growth += 5;
      gameState.totalPoints += 15;

      // Animation
      const horseArea = document.getElementById('horseArea');
      horseArea.classList.add('happy-animation');
      setTimeout(() => horseArea.classList.remove('happy-animation'), 800);

      if (typeof EAI !== 'undefined') {
        EAI.showToast('üéæ Brincando! +25 felicidade', 'success');
      }

      advanceTime();
      checkEvolution();
      updateUI();
    }

    // Brush horse
    function brushHorse() {
      gameState.horse.happiness = Math.min(100, gameState.horse.happiness + 20);
      gameState.horse.growth += 3;
      gameState.totalPoints += 10;

      if (typeof EAI !== 'undefined') {
        EAI.showToast('ü™Æ Escovando! +20 felicidade', 'success');
      }

      advanceTime();
      checkEvolution();
      updateUI();
    }

    // Sleep/advance day
    function sleepHorse() {
      gameState.day++;
      gameState.timeOfDay = 'morning';

      // Recovery during sleep
      gameState.horse.happiness = Math.min(100, gameState.horse.happiness + 10);
      gameState.horse.hunger = Math.max(0, gameState.horse.hunger - 15);

      // Growth bonus for sleeping
      gameState.horse.growth += 10;
      gameState.totalPoints += 20;

      // Character also grows
      gameState.character.growth += 10;

      // Check character evolution
      if (gameState.character.growth >= 100 && gameState.character.stage < 2) {
        gameState.character.stage++;
        gameState.character.growth = 0;
        renderCharacter();
        showAchievement('üë§', 'Voc√™ cresceu!', 'Voc√™ est√° ficando mais velho!');
      }

      // Give daily coins
      if (typeof EAI !== 'undefined') {
        EAI.giveGameReward({
          gameType: 'simulation',
          baseReward: 5,
          accuracy: 100
        });
      }

      checkEvolution();
      updateUI();

      if (typeof EAI !== 'undefined') {
        EAI.showToast(`üò¥ Dia ${gameState.day}! Bom dia!`, 'info');
      }
    }

    // Advance time of day
    function advanceTime() {
      const currentIndex = TIME_CYCLE.indexOf(gameState.timeOfDay);
      const nextIndex = (currentIndex + 1) % TIME_CYCLE.length;
      gameState.timeOfDay = TIME_CYCLE[nextIndex];

      // Natural stat decay
      gameState.horse.hunger = Math.max(0, gameState.horse.hunger - 5);
      gameState.horse.happiness = Math.max(0, gameState.horse.happiness - 3);
    }

    // Check for evolution
    function checkEvolution() {
      // Check horse evolution
      for (let i = STAGES.horse.length - 1; i >= 0; i--) {
        if (gameState.horse.growth >= STAGES.horse[i].growthNeeded && gameState.horse.stage < i && i < 3) {
          evolveHorse(i);
          break;
        }
      }

      // Check unicorn evolution
      if (gameState.totalPoints >= 1000 && !gameState.horse.isUnicorn && gameState.horse.stage >= 2) {
        evolveToUnicorn();
      }
    }

    // Evolve horse
    function evolveHorse(newStage) {
      gameState.horse.stage = newStage;

      const horseArea = document.getElementById('horseArea');
      horseArea.classList.add('evolving');

      setTimeout(() => {
        renderHorse();
        horseArea.classList.remove('evolving');

        const stage = STAGES.horse[newStage];
        showAchievement(stage.emoji, 'Evolu√ß√£o!', `Seu cavalo evoluiu para ${stage.name}!`);

        // Reward
        if (typeof EAI !== 'undefined') {
          EAI.giveGameReward({
            gameType: 'achievement',
            baseReward: 50,
            accuracy: 100
          });
        }
      }, 1000);
    }

    // Evolve to unicorn
    function evolveToUnicorn() {
      gameState.horse.isUnicorn = true;
      gameState.horse.stage = 3;

      const horseArea = document.getElementById('horseArea');
      horseArea.classList.add('evolving');

      setTimeout(() => {
        renderHorse();
        horseArea.classList.remove('evolving');

        showAchievement('ü¶Ñ', 'UNIC√ìRNIO!', 'Incr√≠vel! Seu cavalo se transformou em um unic√≥rnio m√°gico!');

        // Big reward
        if (typeof EAI !== 'undefined') {
          EAI.giveGameReward({
            gameType: 'achievement',
            baseReward: 200,
            accuracy: 100
          });
        }
      }, 1500);
    }

    // Show achievement popup
    function showAchievement(emoji, title, desc) {
      document.getElementById('achieveEmoji').textContent = emoji;
      document.getElementById('achieveTitle').textContent = title;
      document.getElementById('achieveDesc').textContent = desc;
      document.getElementById('achievementPopup').classList.remove('hidden');
    }

    function closeAchievement() {
      document.getElementById('achievementPopup').classList.add('hidden');
    }

    // Game loop for natural decay
    function startGameLoop() {
      setInterval(() => {
        // Slight decay over time
        gameState.horse.hunger = Math.max(0, gameState.horse.hunger - 0.5);
        gameState.horse.happiness = Math.max(0, gameState.horse.happiness - 0.3);

        // Penalty for low stats
        if (gameState.horse.hunger < 20) {
          gameState.horse.happiness = Math.max(0, gameState.horse.happiness - 1);
        }

        updateUI();
      }, 10000); // Every 10 seconds
    }

    // Color helper
    function shadeColor(color, percent) {
      const num = parseInt(color.replace('#', ''), 16);
      const amt = Math.round(2.55 * percent);
      const R = (num >> 16) + amt;
      const G = (num >> 8 & 0x00FF) + amt;
      const B = (num & 0x0000FF) + amt;
      return '#' + (0x1000000 +
        (R < 255 ? R < 1 ? 0 : R : 255) * 0x10000 +
        (G < 255 ? G < 1 ? 0 : G : 255) * 0x100 +
        (B < 255 ? B < 1 ? 0 : B : 255)
      ).toString(16).slice(1);
    }

    // Check for saved game on load
    window.onload = function() {
      if (loadGame() && gameState.gender) {
        document.getElementById('introScreen').classList.add('hidden');
        document.getElementById('gameContainer').classList.remove('hidden');
        initGame();
      }
    };
  </script>
</body>
</html>
